# Plataforma de Renta de Herramientas y Equipos de Construcci√≥n üõ†Ô∏è

## Descripcion.

Este proyecto tiene como objetivo desarrollar una Plataforma de Renta de Herramientas y Equipos de Construcci√≥n, donde los proveedores puedan registrar su inventario y los clientes puedan alquilar herramientas, programar entregas y gestionar pagos de forma eficiente.

[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.1.5-green)](https://spring.io/projects/spring-boot)
[![Java](https://img.shields.io/badge/Java-21-orange)](https://www.oracle.com/java/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-16-blue)](https://www.postgresql.org/)

> **Frontend Repository**: [GitHub Link](https://github.com/Jhormancastella/Proyecto_RentaHerramientas_Frontend_Jhormancastellanos_LuisTalero_LisethArevalo)

## üöÄ Ejecuci√≥n del Proyecto

## clonar los siguientes repositorios

```bash
# Backend
git clone https://github.com/Jhormancastella/Proyecto_RentaHerramientas_backend_Jhormancastellanos_LuisTalero_LisethArevalo.git
mvn spring-boot:run
```

```bash
# Frontend
git clone https://github.com/Jhormancastella/Proyecto_RentaHerramientas_Frontend_Jhormancastellanos_LuisTalero_LisethArevalo.git
open index.html
```

---

## üìä Diagrama de Flujo del Backend 

```mermaid
%% @theme default
flowchart TD
    %% Dominio (Entidades)
    subgraph "Dominio (Core)"
        A((üõ†Ô∏è Herramienta))
        B((üë§ Usuario))
        C((üìÖ Alquiler))
        D((üíµ Pago))
    end

    %% Capa de Aplicaci√≥n
    subgraph "Capa de Aplicaci√≥n"
        E[[üõ†Ô∏è HerramientaService]]
        F[[üë§ UsuarioService]]
        G[[üìÖ AlquilerService]]
        H[[üíµ PagoService]]
    end

    %% Capa de Infraestructura
    subgraph "Capa de Infraestructura"
        subgraph "Repositorios JPA"
            I[[üóÉÔ∏è HerramientaRepository]]
            J[[üë§ UsuarioRepository]]
            K[[üìÖ AlquilerRepository]]
            L[[üíµ PagoRepository]]
        end
        subgraph "Seguridad"
            M[[üîí JwtTokenFilter]]
            N[[üõ°Ô∏è SecurityConfig]]
        end
    end

    %% API REST
    subgraph "Controladores"
        O[[üõ†Ô∏è HerramientaController]]
        P[[üë§ AuthController]]
        Q[[üìÖ AlquilerController]]
        R[[üíµ PagoController]]
    end

    %% Configuraci√≥n
    subgraph "Configuraci√≥n"
        S[[‚öôÔ∏è ApplicationConfig]]
        T[[üìÑ application.properties]]
    end

    %% Punto de entrada
    U[[üèÅ RentadeherramientasApplication]]

    %% Relaciones
    U --> S
    S --> T
    O --> E
    P --> F
    Q --> G
    R --> H
    E --> A & I
    F --> B & J
    G --> C & K
    H --> D & L
    I & J & K & L --> PostgreSQL((üõ¢Ô∏è PostgreSQL))
    M --> N
    P --> M
```

## üìä Diagrama de Flujo del Frontend

```mermaid
%% @theme default
flowchart TD
    %% P√°ginas HTML
    subgraph "Vistas"
        A((üè† index.html))
        B((üîë login.html))
        C((üë§ user.html))
        D((üè≠ provider.html))
        E((üëë admin.html))
        F((üìù register.html))
    end

    %% L√≥gica JavaScript
    subgraph "Scripts"
        G[[üîë login.js]]
        H[[üë§ user.js]]
        I[[üè≠ provider.js]]
        J[[üëë admin.js]]
        K[[üìù register.js]]
        L[[üõ†Ô∏è productos.js]]
    end

    %% Servicios
    subgraph "API"
        M[[üåê api.js]]
        N[[üîÑ environment.js]]
    end

    %% Estilos
    subgraph "CSS"
        O[[üé® styles.css]]
    end

    %% Flujo Principal
    A -->|"Iniciar Sesi√≥n"| B
    B --> G
    G -->|"POST /api/auth/login"| Backend((üöÄ Backend))
    G -->|"Redirige por Rol"| C & D & E
    C --> H
    D --> I
    E --> J
    F --> K
    H & I & J & K & L --> M
    M -->|"Fetch/Axios"| Backend
    O --> A & B & C & D & E & F
```

## üìä Diagrama Entidad-Relaci√≥n (ER)

```mermaid
erDiagram
    USERS {
        bigint id PK
        boolean active
        string address
        string email
        string first_name
        string last_name
        string password
        string phone
        string username
    }

    ADMINS {
        bigint id PK
        boolean active
        timestamp created_at
        string email
        string first_name
        timestamp last_login
        string last_name
        string password
        string phone
        timestamp updated_at
        string username
    }

    ROLES {
        bigint id PK
        string name
    }

    TOOLS {
        bigint id PK
        boolean available
        string category
        string description
        string image_url
        string name
        numeric rental_price
        string serial_number
        integer stock
    }

    ALQUILERES {
        bigint id PK
        numeric costo_total
        string estado
        timestamp fecha_actualizacion
        timestamp fecha_creacion
        timestamp fecha_fin
        timestamp fecha_inicio
        string observaciones
        bigint tool_id FK
        bigint user_id FK
    }

    RESERVATIONS {
        bigint id PK
        timestamp created_at
        timestamp end_date
        string notes
        timestamp start_date
        string status
        numeric total_amount
        timestamp updated_at
        bigint tool_id FK
        bigint user_id FK
    }

    INVOICES {
        bigint id PK
        timestamp created_at
        timestamp due_date
        string invoice_number
        timestamp issue_date
        string notes
        string status
        numeric subtotal
        numeric tax_amount
        numeric total_amount
        timestamp updated_at
        bigint reservation_id FK
    }

    PAYMENTS {
        bigint id PK
        numeric amount
        timestamp created_at
        string method
        timestamp payment_date
        string payment_details
        string status
        string transaction_id
        timestamp updated_at
        bigint reservation_id FK
    }

    DAMAGE_REPORTS {
        bigint id PK
        string description
        date report_date
        string reported_by
        string status
        bigint tool_id FK
    }

    PRODUCTOS {
        bigint id PK
        string categoria
        string descripcion
        boolean disponible
        string imagen_url
        string nombre
        double precio
        integer stock
    }

    PROVEEDORES {
        bigint id PK
        boolean activo
        string ciudad
        string contacto
        string email
        string nombre
        string telefono
    }

    NOTIFICATIONS {
        bigint id PK
        timestamp created_at
        string link
        string message
        timestamp read_at
        string status
        string title
        string type
        timestamp updated_at
        bigint user_id FK
    }

    USER_ROLES {
        bigint user_id PK,FK
        bigint role_id PK,FK
    }

    ADMIN_ROLES {
        bigint admin_id PK,FK
        bigint role_id PK,FK
    }

    USERS ||--o{ ALQUILERES : "realiza"
    TOOLS ||--o{ ALQUILERES : "es_alquilada"
    USERS ||--o{ RESERVATIONS : "hace"
    TOOLS ||--o{ RESERVATIONS : "es_reservada"
    RESERVATIONS ||--|| INVOICES : "genera"
    RESERVATIONS ||--|| PAYMENTS : "tiene"
    TOOLS ||--o{ DAMAGE_REPORTS : "tiene_reportes"
    USERS ||--o{ NOTIFICATIONS : "recibe"
    USERS }|--|| USER_ROLES : "tiene"
    ROLES }|--|| USER_ROLES : "asignado"
    ADMINS }|--|| ADMIN_ROLES : "tiene"
    ROLES }|--|| ADMIN_ROLES : "asignado"
```

## üîê Credenciales de Prueba Autom√°ticas

Al iniciar el servidor, se crean estos usuarios (generados por `data.sql`):

| Rol           | Username     | Password       |
| ------------- | ------------ | -------------- |
| **Admin**     | `admin`      | `admin123`     |
| **Proveedor** | `proveedor1` | `proveedor123` |
| **Cliente**   | `user1`      | `password1`    |

---

---

## üõ†Ô∏è Instalaci√≥n y Configuraci√≥n del Proyecto

### üìã Requisitos Previos

- **Java JDK 21** ([Descargar](https://www.oracle.com/java/technologies/javase/jdk21-archive-downloads.html))
- **PostgreSQL 16** ([Descargar](https://www.postgresql.org/download/))
- **Maven 3.9+** ([Instrucciones](https://maven.apache.org/install.html))
- **Live Server**
- **Visual Studio Code** (Recomendado) o cualquier IDE para Java/Web

### üîß Pasos para Configurar el Proyecto

#### 1. Configurar Base de Datos (PostgreSQL)

1. Crear una base de datos llamada `renta_herramientas`
2. Configurar credenciales en `backend/src/main/resources/application.properties`:

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/rentadeherramientas
spring.datasource.username=Postgres
spring.datasource.password=tu_contrase√±a_postgres
spring.jpa.hibernate.ddl-auto=update
```

#### 2. Ejecutar el Backend (Spring Boot)

```bash
cd Proyecto_RentaHerramientas_backend_Jhormancastellanos_LuisTalero_LisethArevalo
mvn spring-boot:run
```

‚úÖ El servidor se iniciar√° en `http://localhost:8080`

#### 3. Ejecutar el Frontend

1. Abrir el proyecto frontend en VSCode
2. Instalar la extensi√≥n **Live Server** (si no la tienes)
3. Abrir `index.html` y hacer clic en **Go Live** (esquina inferior derecha de VSCode)
4. Se abrir√° autom√°ticamente en `http://localhost:5500`

---

## üñ•Ô∏è Flujo de Ejecuci√≥n del Sistema

1. **P√°gina de Bienvenida** (`index.html`):
   - Interfaz inicial con logo y descripci√≥n del sistema
   - Bot√≥n "registro" que redirige a `/register.html`

2. **Login**:
   - Introducir credenciales de prueba (admin/admin123, etc.)
   - El frontend consume el endpoint `POST /api/auth/Authenticate`

3. **Redirecci√≥n seg√∫n Rol**:
   - `ADMIN` ‚Üí Panel de administraci√≥n (`/admin/admin.html`)
   - `PROVEEDOR` ‚Üí Gesti√≥n de herramientas (`/proveedor/provider.html`)
   - `CLIENTE` ‚Üí Cat√°logo de herramientas (`/cliente/user.html`)

---

## üö¶ Estructura de Archivos (Frontend)

```plaintext
üì¶ PROYECTO_RENTAHERRAMIENTAS_FRONTEND_JHORM...
‚îÇ
‚îú‚îÄ‚îÄ üìÇ css/ # üé® Estilos globales
‚îÇ ‚îî‚îÄ‚îÄ üåÄ styles.css # (Archivo principal)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ images/ # üñºÔ∏è Assets visuales
‚îÇ ‚îî‚îÄ‚îÄ üìÑ .gitkeep # (Carpeta vac√≠a)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ js/ # üß† L√≥gica JavaScript
‚îÇ ‚îú‚îÄ‚îÄ üìú admin.js # üë®üíº Panel administrador
‚îÇ ‚îú‚îÄ‚îÄ üìú charts.js # üìä Gr√°ficos (opcional)
‚îÇ ‚îú‚îÄ‚îÄ üìú environment.js # üå± Config variables
‚îÇ ‚îú‚îÄ‚îÄ üìú login.js # üîë Autenticaci√≥n
‚îÇ ‚îú‚îÄ‚îÄ üìú productos.js # üõ†Ô∏è Gesti√≥n de herramientas
‚îÇ ‚îú‚îÄ‚îÄ üìú provider.js # üè≠ Panel proveedor
‚îÇ ‚îú‚îÄ‚îÄ üìú register.js # üìù Registro usuarios
‚îÇ ‚îú‚îÄ‚îÄ üìú user.js # üë§ Panel cliente
‚îÇ ‚îî‚îÄ‚îÄ üìú welcome.js # üè† P√°gina inicial
‚îÇ
‚îú‚îÄ‚îÄ üìÇ media/ # üìÅ Multimedia adicional
‚îÇ ‚îî‚îÄ‚îÄ üìÑ .gitkeep # (Carpeta vac√≠a)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ pages/ # üñ•Ô∏è Vistas HTML
‚îÇ ‚îú‚îÄ‚îÄ üìÑ admin.html # üë®üíº Dashboard admin
‚îÇ ‚îú‚îÄ‚îÄ üìÑ login.html # üîë Inicio de sesi√≥n
‚îÇ ‚îú‚îÄ‚îÄ üìÑ provider.html # üè≠ Vista proveedor
‚îÇ ‚îú‚îÄ‚îÄ üìÑ register.html # üìù Registro
‚îÇ ‚îú‚îÄ‚îÄ üìÑ user.html # üë§ Perfil cliente
‚îÇ ‚îî‚îÄ‚îÄ üìÑ index.html # üè† P√°gina principal
‚îÇ
‚îú‚îÄ‚îÄ üìÇ api/ # üåê Conexi√≥n backend
‚îÇ ‚îî‚îÄ‚îÄ üìú api.js # (Fetch/Axios config)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ bootstrap/ # üÖ±Ô∏è Estilos Bootstrap
‚îÇ ‚îî‚îÄ‚îÄ üìÑ bootstrap.min.css # (Si se usa)
‚îÇ
‚îî‚îÄ‚îÄ üìÑ README.md # üìñ Documentaci√≥n
```

## üóÇÔ∏è Estructura del Proyecto (Backend)

```plaintext
üì¶ rentadeherramientas/
‚îú‚îÄ‚îÄ üìÇ src/
‚îÇ ‚îú‚îÄ‚îÄ üìÇ main/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ java/
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üìÇ com.rentadeherramientas.rentadeherramientas/
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ Config/ # ‚öôÔ∏è Configuraciones
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ application.services/ # üõ†Ô∏è Servicios
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ domain.entity/ # üè∑Ô∏è Entidades JPA
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ dto/ # üì¶ Objetos de transferencia
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ request/ # üì• Peticiones HTTP
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ response/ # üì§ Respuestas HTTP
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ exceptions/ # ‚ùå Excepciones
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ exception/ # üö® Manejo de errores
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÇ infrastructure/ # üåê Infraestructura
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üéØ RentadeherramientasApplication.java # üöÄ Clase principal
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üìÇ resources/ # üìÑ Recursos
‚îÇ ‚îî‚îÄ‚îÄ üìÇ target/ # üèóÔ∏è Generado por Maven
‚îÇ ‚îî‚îÄ‚îÄ üìÇ generated-sources/annotations/ # üîÑ C√≥digo generado
‚îú‚îÄ‚îÄ üìÇ .mvn/ # ‚öôÔ∏è Config Maven Wrapper
‚îú‚îÄ‚îÄ üìÇ .vscode/ # üîß Configuraci√≥n IDE
‚îú‚îÄ‚îÄ üìÑ .gitattributes # üîç Reglas Git
‚îú‚îÄ‚îÄ üìÑ .gitignore # üôà Archivos ignorados
‚îú‚îÄ‚îÄ üìÑ README.md # üìñ Documentaci√≥n
‚îú‚îÄ‚îÄ üìÑ mvnw # üêß Maven Wrapper (Linux)
‚îú‚îÄ‚îÄ üìÑ mvnw.cmd # ÔøΩ Maven Wrapper (Windows)
‚îî‚îÄ‚îÄ üìÑ pom.xml # üì¶ Dependencias Maven
```

---

## üîç Soluci√≥n de Problemas Comunes

### ‚ùå El backend no se inicia

- Verifica que PostgreSQL est√© corriendo: `sudo service postgresql status`
- Revisa los logs de Spring Boot: `mvn spring-boot:run` muestra errores de conexi√≥n

### ‚ùå El frontend no conecta con el backend

- Aseg√∫rate que CORS est√° habilitado en Spring Boot:

```java
@Bean
public WebMvcConfigurer corsConfigurer() {
    return new WebMvcConfigurer() {
        @Override
        public void addCorsMappings(CorsRegistry registry) {
            registry.addMapping("/**").allowedOrigins("http://localhost:5500");
        }
    };
}
```

### ‚ùå Live Server no funciona

- Inst√°lalo desde VSCode Extensions (ID: ritwickdey.LiveServer)
- Alternativa: Usar `python3 -m http.server 8000` en la carpeta frontend
- 

## üö® Estado del Ejercicio

**Sin Culminar**  
*(En desarrollo activo)*

---

## üë• Autores

<div style="display: flex; gap: 20px; align-items: center; margin-top: 15px;">
  <img src="https://avatars.githubusercontent.com/u/123456789?v=4" width="60" style="border-radius: 50%;">
  <div>
    <h4>Jhorman Jes√∫s Castellanos Morales</h4>
    <p>Desarrollador Backend</p>
    <a href="https://github.com/Jhormancastella" target="_blank">@Jhormancastella</a>
  </div>
</div>


<div style="display: flex; gap: 20px; align-items: center; margin-top: 15px;">
  <img src="https://avatars.githubusercontent.com/u/123456789?v=4" width="60" style="border-radius: 50%;">
  <div>
    <h4>Luis Talero</h4>
    <p>Desarrollador Frontend</p>
        <a href="https://github.com/luistalero" target="_blank">@luistalero</a>
  </div>
</div>


<div style="display: flex; gap: 20px; align-items: center; margin-top: 15px;">
  <img src="https://avatars.githubusercontent.com/u/123456789?v=4" width="60" style="border-radius: 50%;">
  <div>
    <h4>Liseth Ar√©valo</h4>
    <p>Dise√±adora de Base de Datos</p>
        <a href="https://github.com/lisethflorez" target="_blank">@lisethflorez</a>
  </div>
</div>

